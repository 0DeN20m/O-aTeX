\ProvidesPackage{my-common}[2026/02/09 汎用コマンド]

% Packages --------------------------------------

\RequirePackage{luatexja}
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\RequirePackage{makeidx} % 索引作成用
\RequirePackage{luatexja-ruby} % ルビ作成用
\RequirePackage[unicode=true]{hyperref}
\RequirePackage{cleveref} % 参照時に自動で名前を付与
\RequirePackage{autonum} % 参照しない数式から番号を削除

% Formatting ------------------------------------

% 式番号にセクション番号を付与
\numberwithin{equation}{section}

% 数式の途中改行許可
\allowdisplaybreaks[1]

% cleveref --------------------------------------

\crefname{equation}{式}{式}
\crefname{figure}{図}{図}
\crefname{table}{表}{表}

% 定理環境
\crefname{axiom}{公理}{公理}
\crefname{axiom*}{公理}{公理}
\crefname{definition}{定義}{定義}
\crefname{definition*}{定義}{定義}
\crefname{proposition}{命題}{命題}
\crefname{proposition*}{命題}{命題}
\crefname{theorem}{定理}{定理}
\crefname{theorem*}{定理}{定理}
\crefname{lemma}{補題}{補題}
\crefname{lemma*}{補題}{補題}
\crefname{corollary}{系}{系}
\crefname{corollary*}{系}{系}
\crefname{example}{例}{例}
\crefname{example*}{例}{例}
\crefname{question}{問題}{問題}
\crefname{question*}{問題}{問題}
\crefname{answer}{解答例}{解答例}
\crefname{answer*}{解答例}{解答例}
\crefname{proof}{証明}{証明}

% 接続詞
\newcommand\crefpairconjunction{と} % 2つのとき
\newcommand\crefrangeconjunction{から} % 連続する3つ以上のとき
\newcommand\crefmiddleconjunction{，} % 連続しない3つ以上のときの中間

% Environments ----------------------------------

\newtheorem{axiom}{公理}[section]
\newtheorem*{axiom*}{公理}
\newtheorem{definition}[axiom]{定義}
\newtheorem*{definition*}{定義}

\newtheorem{proposition}{命題}[section]
\newtheorem*{proposition*}{命題}
\newtheorem{theorem}[proposition]{定理}
\newtheorem*{theorem*}{定理}
\newtheorem{lemma}[proposition]{補題}
\newtheorem*{lemma*}{補題}
\newtheorem{corollary}[proposition]{系}
\newtheorem*{corollary*}{系}
\newtheorem*{myproof}{証明}
% 既存の証明環境を上書き
\renewenvironment{proof}{\begin{myproof}}{\end{myproof}}

\newtheorem{example}{例}[section]
\newtheorem*{example*}{例}

\newtheorem{question}{問題}[section]
\newtheorem*{question*}{問題}
\newtheorem{answer}{解答例}[section]
\newtheorem*{answer*}{解答例}

% functions -------------------------------------

% 関数記号の定義を簡略化するマクロ
% 
% * : 添え字位置を指定（*ありで上下，無しで右上右下）
% o : フォント（デフォルトは\mathrm）
% m : 関数名
% o : 下付き添え字（オプション）
% o : 上付き添え字（オプション）
\NewDocumentCommand\GenericMathOperator{somoo}{
  \mathop{
    \IfValueTF{#2}{#2{#3}}{\mathrm{#3}}
  }
  \IfBooleanTF{#1}{\limits}{\nolimits}
  \IfValueT{#4}{_{#4}}
  \IfValueT{#5}{^{#5}}
}

% タプル系統の定義を簡略化するマクロ
% 
% m : 左括弧記号
% m : 右括弧記号
% m : 中身
% o : 下付き添え字（オプション）
% o : 上付き添え字（オプション）
\NewDocumentCommand\GenericTuple{mmmoo}{
  \left#1 #3 \right#2
  \IfValueT{#4}{_{#4}}
  \IfValueT{#5}{^{#5}}
}

% 変数系統の定義を簡略化するマクロ
%
% o : フォント（デフォルトはそのまま）
% m : 変数名
% o : 下付き添え字（オプション）
% o : 上付き添え字（オプション）
\NewDocumentCommand\GenericVariable{omoo}{
  \IfValueTF{#2}{#2{#1}}{#1}
  \IfValueT{#3}{_{#3}}
  \IfValueT{#4}{^{#4}}
}

% Symbols ---------------------------------------

% 自然数の集合
\NewDocumentCommand\naturalnumbers{}{\mathord{\mathbb{N}}}
% 整数の集合
\NewDocumentCommand\integers{}{\mathord{\mathbb{Z}}}
% 有理数の集合
\NewDocumentCommand\rationalnumbers{}{\mathord{\mathbb{Q}}}
% 実数の集合
\NewDocumentCommand\realnumbers{}{\mathord{\mathbb{R}}}
% 複素数の集合
\NewDocumentCommand\complexnumbers{}{\mathord{\mathbb{C}}}
% ダミー変数
\NewDocumentCommand\dummy{}{\mathord{-}}

% Tuples ---------------------------------------

% タプル
\NewDocumentCommand\tuple{m}{\GenericTuple{(}{)}{#1}}

% ノルム
\NewDocumentCommand\norm{om}{\GenericTuple{\|}{\|}{#2}[#1]}

% 内積
\NewDocumentCommand\innerproduct{omm}{\GenericTuple{\langle}{\rangle}{#2, #3}[#1]}

% Operators -------------------------------------

% 恒等射
\NewDocumentCommand\identitymap{o}{\GenericMathOperator{id}[#1]}

% 自己同型
\NewDocumentCommand\automorphisms{o}{\GenericMathOperator{Aut}[#1]}
% 自己準同型
\NewDocumentCommand\endomorphisms{o}{\GenericMathOperator{End}[#1]}
% Hom集合
\NewDocumentCommand\homset{o}{\GenericMathOperator{Hom}[#1]}
% 等長変換群
\NewDocumentCommand\isometries{o}{\GenericMathOperator{Isom}[#1]}

% Variables ------------------------------------- 

% 距離
\NewDocumentCommand\distance{om}{\GenericVariable{#2}[#1]}

% makeidx ---------------------------------------

% 用語定義を行う．
% 
% 第1引数：読み（オプション）
% 第2引数：用語（必須）
% 第3引数：別名（オプション）
% 
% TODO: 別名も\index{#3|seealso{#1}}で登録できるようにしたい！
% 
% 使用例：\Term[へんびぶんほうていしき]{偏微分方程式}[Partial Differential Equation; PDE]
%   -> 偏微分方程式（Partial Differential Equation; PDE）
\NewDocumentCommand\term{omo}{
  \IfValueTF{#1}{\emph{\ruby{#2}{#1}}\index{#1@#2}}{\emph{#2}\index{#2}}
  \IfValueT{#3}{（#3）}
}